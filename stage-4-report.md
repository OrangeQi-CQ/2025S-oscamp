# 2025 春季开源操作系统训练营报告

程琦，华南理工大学电力学院，电气工程及其自动化专业本科。

## 一、工作概述

### 1.1 核心工作

1. 编写一整完整的页缓存系统，接入文件和 mmap相关系统调用，pr 正在 review。
2. 实现一套共享内存机制，帮助部分同学通过全国大学生 OS 比赛地 iozone 测例。

### 1.2 辅助工作

1. 修改 arceos，以适配页缓存。
2. 完善 page_table_multiarch 组件。

## 二、页缓存系统

### 2.1 页缓存架构设计：文件

### 2.2 页缓存架构设计：mmap

### 2.3 延迟加载：lazy-alloc 机制

### 2.4 页表反向映射

页表反向映射的概念：
- 多个虚拟页面可能同时映射到同一个物理页面，主要出现在多个进程共享 mmap 同一个文件；
- 我们需要根据物理页面反向找到 **所有** 映射到它的虚拟页面 `(pid, virt_page_num)`。

应用场景：
- 脏页查询，需要访问所有的相关页表项，检查 `Dirty` 位；
-  页面置换：需要修改所有的相关页表，取消页面映射。

实现方法：
-  每个页面都维护一个**映射集合**，记录所有映射到它的虚拟页面 `(pid, addr)`；
- 在 mmap 后的 lazy-alloc 时，进程的虚拟页面会映射到页缓存的物理页面，此时将映射关系加入页面映射集合；
- 在 munmap 时，需要取消某一个映射关系，从该页面的映射集合中删除相应的 `(pid, addr)`；
- 在页面置换时，需要取消该页面的所有映射关系，此时清空该页面的映射集合。

### 2.5 脏页管理与页面置换

### 2.6 并发安全

### 2.7 测试

### 2.7 性能分析

### 2.8 局限性与展望

## 三、共享内存机制

## 四、训练营收获